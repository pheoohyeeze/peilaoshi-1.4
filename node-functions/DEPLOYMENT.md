# Edge One éƒ¨ç½²æŒ‡å—

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. å‡†å¤‡å·¥ä½œ

#### 1.1 ç¡®ä¿æ–‡ä»¶ç»“æ„æ­£ç¡®

ç¡®ä¿ä½ çš„ `node-functions` ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```
node-functions/
â”œâ”€â”€ [[default]].js          # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ package.json            # ä¾èµ–é…ç½®
â”œâ”€â”€ config/
â”‚   â””â”€â”€ database.js         # æ•°æ®åº“é…ç½®
â”œâ”€â”€ api/                    # API è·¯ç”±
â””â”€â”€ database/
    â””â”€â”€ schema.sql          # æ•°æ®åº“ç»“æ„
```

#### 1.2 æ£€æŸ¥ package.json

ç¡®ä¿ `package.json` ä¸­åŒ…å«æ‰€æœ‰å¿…è¦çš„ä¾èµ–ï¼š

```json
{
  "dependencies": {
    "express": "^4.18.2",
    "mysql2": "^3.6.5",
    "cors": "^2.8.5",
    "dotenv": "^16.3.1",
    "helmet": "^7.1.0",
    "morgan": "^1.10.0"
  }
}
```

### 2. æ•°æ®åº“å‡†å¤‡

#### 2.1 åˆ›å»º MySQL æ•°æ®åº“

åœ¨ä½ çš„ MySQL æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š

```sql
CREATE DATABASE hsk_vocabulary CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

#### 2.2 å¯¼å…¥æ•°æ®åº“ç»“æ„

```bash
mysql -u your_username -p hsk_vocabulary < database/schema.sql
```

### 3. Edge One æ§åˆ¶å°é…ç½®

#### 3.1 ç™»å½• Edge One æ§åˆ¶å°

1. è®¿é—® [Edge One æ§åˆ¶å°](https://console.cloud.tencent.com/edgeone)
2. é€‰æ‹©ä½ çš„ç«™ç‚¹
3. è¿›å…¥ "å‡½æ•°è®¡ç®—" æˆ– "Edge Functions" é¡µé¢

#### 3.2 åˆ›å»º Node Functions

1. ç‚¹å‡» "æ–°å»ºå‡½æ•°"
2. é€‰æ‹© "Node.js" è¿è¡Œæ—¶
3. å‡½æ•°åç§°ï¼š`hsk-backend` (æˆ–ä½ å–œæ¬¢çš„åç§°)

#### 3.3 ä¸Šä¼ ä»£ç 

æœ‰ä¸¤ç§æ–¹å¼ä¸Šä¼ ä»£ç ï¼š

**æ–¹å¼ä¸€ï¼šç›´æ¥ä¸Šä¼ æ–‡ä»¶**

1. å°†æ•´ä¸ª `node-functions` ç›®å½•å‹ç¼©ä¸º ZIP æ–‡ä»¶
2. åœ¨ Edge One æ§åˆ¶å°ä¸Šä¼  ZIP æ–‡ä»¶

**æ–¹å¼äºŒï¼šGit é›†æˆ**

1. å°†ä»£ç æ¨é€åˆ° Git ä»“åº“
2. åœ¨ Edge One æ§åˆ¶å°é…ç½® Git é›†æˆ

### 4. ç¯å¢ƒå˜é‡é…ç½®

åœ¨ Edge One æ§åˆ¶å°è®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

#### 4.1 æ•°æ®åº“é…ç½®

```
DB_HOST=your_mysql_host
DB_PORT=3306
DB_USER=your_mysql_username
DB_PASSWORD=your_mysql_password
DB_NAME=hsk_vocabulary
```

#### 4.2 åº”ç”¨é…ç½®

```
NODE_ENV=production
FRONTEND_URL=https://your-frontend-domain.com
```

### 5. éƒ¨ç½²é…ç½®

#### 5.1 å‡½æ•°é…ç½®

- **å…¥å£æ–‡ä»¶**: `[[default]].js`
- **è¶…æ—¶æ—¶é—´**: 30 ç§’
- **å†…å­˜**: 128MB (å¯æ ¹æ®éœ€è¦è°ƒæ•´)
- **å¹¶å‘æ•°**: 10 (å¯æ ¹æ®éœ€è¦è°ƒæ•´)

#### 5.2 è§¦å‘é…ç½®

- **è§¦å‘å™¨ç±»å‹**: HTTP è§¦å‘å™¨
- **è¯·æ±‚æ–¹æ³•**: GET, POST, PUT, DELETE, PATCH
- **è·¯å¾„**: `/api/*` æˆ– `/*` (æ ¹æ®ä½ çš„éœ€æ±‚)

### 6. åŸŸåç»‘å®š

#### 6.1 è‡ªå®šä¹‰åŸŸå

1. åœ¨ Edge One æ§åˆ¶å°æ·»åŠ è‡ªå®šä¹‰åŸŸå
2. é…ç½® CNAME è®°å½•æŒ‡å‘ Edge One
3. ç»‘å®šåˆ°ä½ çš„ Node Functions

#### 6.2 API è·¯å¾„é…ç½®

å»ºè®®çš„ API è·¯å¾„ç»“æ„ï¼š

```
https://your-domain.com/api/vocabulary/list
https://your-domain.com/api/progress
https://your-domain.com/api/lessons
```

### 7. éƒ¨ç½²å’Œæµ‹è¯•

#### 7.1 éƒ¨ç½²å‡½æ•°

1. ç‚¹å‡» "éƒ¨ç½²" æŒ‰é’®
2. ç­‰å¾…éƒ¨ç½²å®Œæˆ
3. æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—ç¡®è®¤æ— é”™è¯¯

#### 7.2 æµ‹è¯• API

éƒ¨ç½²å®Œæˆåï¼Œæµ‹è¯•ä»¥ä¸‹ç«¯ç‚¹ï¼š

```bash
# å¥åº·æ£€æŸ¥
curl https://your-domain.com/health

# è·å–è¯æ±‡åˆ—è¡¨
curl https://your-domain.com/api/vocabulary/list

# è·å–è¯¾ç¨‹åˆ—è¡¨
curl https://your-domain.com/api/lessons
```

### 8. ç›‘æ§å’Œæ—¥å¿—

#### 8.1 æŸ¥çœ‹æ—¥å¿—

åœ¨ Edge One æ§åˆ¶å°æŸ¥çœ‹å‡½æ•°æ‰§è¡Œæ—¥å¿—ï¼š

1. è¿›å…¥å‡½æ•°è¯¦æƒ…é¡µ
2. ç‚¹å‡» "æ—¥å¿—" æ ‡ç­¾
3. æŸ¥çœ‹å®æ—¶æ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯

#### 8.2 ç›‘æ§æŒ‡æ ‡

ç›‘æ§ä»¥ä¸‹æŒ‡æ ‡ï¼š

- è¯·æ±‚æ•°é‡
- å“åº”æ—¶é—´
- é”™è¯¯ç‡
- å†…å­˜ä½¿ç”¨ç‡

### 9. å¸¸è§é—®é¢˜è§£å†³

#### 9.1 æ•°æ®åº“è¿æ¥å¤±è´¥

**é—®é¢˜**: `âŒ Database connection failed`
**è§£å†³æ–¹æ¡ˆ**:

1. æ£€æŸ¥æ•°æ®åº“ä¸»æœºåœ°å€å’Œç«¯å£
2. ç¡®è®¤æ•°æ®åº“ç”¨æˆ·æƒé™
3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
4. éªŒè¯ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®

#### 9.2 æ¨¡å—æ‰¾ä¸åˆ°é”™è¯¯

**é—®é¢˜**: `Cannot find module 'xxx'`
**è§£å†³æ–¹æ¡ˆ**:

1. ç¡®è®¤ `package.json` åŒ…å«æ‰€æœ‰ä¾èµ–
2. æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
3. é‡æ–°ä¸Šä¼ ä»£ç åŒ…

#### 9.3 CORS é”™è¯¯

**é—®é¢˜**: å‰ç«¯æ— æ³•è®¿é—® API
**è§£å†³æ–¹æ¡ˆ**:

1. æ£€æŸ¥ `FRONTEND_URL` ç¯å¢ƒå˜é‡
2. ç¡®è®¤ CORS é…ç½®æ­£ç¡®
3. æ£€æŸ¥åŸŸåç»‘å®š

### 10. æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### 10.1 æ•°æ®åº“ä¼˜åŒ–

- ä½¿ç”¨è¿æ¥æ± ï¼ˆå·²é…ç½®ï¼‰
- æ·»åŠ é€‚å½“çš„ç´¢å¼•
- å®šæœŸæ¸…ç†æ—¥å¿—è¡¨

#### 10.2 ç¼“å­˜ç­–ç•¥

- å¯¹é™æ€æ•°æ®è¿›è¡Œç¼“å­˜
- ä½¿ç”¨ Redis ç¼“å­˜é¢‘ç¹æŸ¥è¯¢çš„æ•°æ®

#### 10.3 ä»£ç ä¼˜åŒ–

- å‹ç¼© JavaScript ä»£ç 
- ç§»é™¤æœªä½¿ç”¨çš„ä¾èµ–
- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢

### 11. å®‰å…¨é…ç½®

#### 11.1 æ•°æ®åº“å®‰å…¨

- ä½¿ç”¨å¼ºå¯†ç 
- é™åˆ¶æ•°æ®åº“ç”¨æˆ·æƒé™
- å¯ç”¨ SSL è¿æ¥

#### 11.2 API å®‰å…¨

- æ·»åŠ è¯·æ±‚é¢‘ç‡é™åˆ¶
- å®ç°èº«ä»½éªŒè¯ï¼ˆå¦‚éœ€è¦ï¼‰
- éªŒè¯è¾“å…¥æ•°æ®

### 12. å¤‡ä»½å’Œæ¢å¤

#### 12.1 ä»£ç å¤‡ä»½

- ä½¿ç”¨ Git ç‰ˆæœ¬æ§åˆ¶
- å®šæœŸå¤‡ä»½ä»£ç åŒ…

#### 12.2 æ•°æ®åº“å¤‡ä»½

```bash
# å¤‡ä»½æ•°æ®åº“
mysqldump -u username -p hsk_vocabulary > backup.sql

# æ¢å¤æ•°æ®åº“
mysql -u username -p hsk_vocabulary < backup.sql
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š

1. æŸ¥çœ‹ Edge One å®˜æ–¹æ–‡æ¡£
2. æ£€æŸ¥å‡½æ•°æ‰§è¡Œæ—¥å¿—
3. è”ç³»è…¾è®¯äº‘æŠ€æœ¯æ”¯æŒ

## ğŸ”— ç›¸å…³é“¾æ¥

- [Edge One å®˜æ–¹æ–‡æ¡£](https://cloud.tencent.com/document/product/1552)
- [Node.js å‡½æ•°æ–‡æ¡£](https://cloud.tencent.com/document/product/1552/81876)
- [MySQL è¿æ¥é…ç½®](https://cloud.tencent.com/document/product/236/3130)
